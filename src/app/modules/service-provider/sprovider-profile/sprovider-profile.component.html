
<!--Profile View-->
<div class="container-fluid" *ngIf="!editmode && serviceProvider">
    <section class="px-md-5 mx-md-5 dark-grey-text">
  

        <div class="row cust-row pd-top-min" *ngIf="isowner">
                <div class="col-md-9">
                </div>
                <div class="col-md-3">
                  <a type="button" mdbBtn color="green" class="waves-light btn btn-md" style="border-radius: 30px;"
                  (click)="editmode = !editmode" mdbWavesEffect (click) = "setCategory()">Edit Profile
                  </a>
                </div>
        </div>
  
  
      <!--profile header-->
      <div class="container-fluid header-cls">
        <div class="row f-image">
        </div>
        <div class="row logo-cls">
          <div class="col-md-3">
              <img src="{{serviceProvider ? serviceProvider.profile_pic : imageUrl}}"
              alt="User Pic" class="img-thumbnail logo-img">
          </div>
          <div class="col-md-9">
            <h2 class="txt-title"> {{serviceProvider ? serviceProvider.first_name : 'Loading...'}}  {{serviceProvider ? serviceProvider.last_name : ' Loading...'}} </h2>
          </div>
        </div>
  
        <!-- profile content-->
        <div class="page-content">
          <div class="content-title" >
            Profile Details
          </div>
            <hr>
  
                  <!--row 1-->
                  <div class="row">
                    <div class="col-md-5 inst-text">
                      <mdb-icon fas icon="user"></mdb-icon> <span> NIC No </span>
  
                    </div>
  
                    <div class="col-md-7 profile-text">
                        <span> {{serviceProvider ? serviceProvider.nic : 'Loading...'}}</span>
                    </div>
                  </div>
                <!--row 1-->
              <div class="row div-content">
                <div class="col-md-5 inst-text">
                  <mdb-icon fas icon="envelope"></mdb-icon> <span> Email </span>
                </div>
  
                <div class="col-md-7 profile-text">
                    <span> {{serviceProvider ? serviceProvider.email : 'Loading...'}}</span>
                </div>
              </div>
  
                 <!--row 2-->
                 <div class="row div-content">
                  <div class="col-md-5 inst-text">
                    <mdb-icon fas icon="phone"></mdb-icon> <span>  Mobile No </span>
                  </div>
  
                  <div class="col-md-7 profile-text">
                      <span> {{serviceProvider ? serviceProvider.contact_no : 'Loading...'}}</span>
                  </div>
                </div>
  
                  <!--row 2-->
                  <div class="row div-content">
                    <div class="col-md-5 inst-text">
                      <mdb-icon fas icon="mercury"></mdb-icon> <span> Gender</span>
                    </div>
  
                    <div class="col-md-7 profile-text">
                        <span> {{serviceProvider ? serviceProvider.gender : 'Loading...'}}</span>
                    </div>
                  </div>
  
                    <!--row 2-->
                    <div class="row div-content" *ngIf="isowner">
                      <div class="col-md-5 inst-text">
                        <mdb-icon fas icon="birthday-cake"></mdb-icon> <span> Date of Birth</span>
                      </div>
  
                      <div class="col-md-7 profile-text">
                          <span> {{serviceProvider ? serviceProvider.date_of_birth.slice(0,10) : 'Loading...'}}</span>
                      </div>
                    </div>
  
                      <!--row 2-->
                      <div class="row div-content">
                        <div class="col-md-5 inst-text">
                          <mdb-icon fas icon="home"></mdb-icon> <span> Address </span>
                        </div>
  
                        <div class="col-md-7 profile-text">
                            <span> {{serviceProvider ? serviceProvider.address_line1 : 'Loading...'}}</span>
                            <br>
                            <span> {{serviceProvider ? serviceProvider.address_line2: ' Loading...'}}</span>
                            <br>
                            <span> District: {{serviceProvider ? serviceProvider.district: ' Loading...'}}</span>
                        </div>
                      </div>
                      <br>
                      <div *ngIf="isowner">
                <div class="content-title" >
                  Account Details
                </div>
                  <hr>
                 <!--row 3-->
                 <div class="row">
                  <div class="col-md-5 inst-text">
                    <mdb-icon fas icon="user"></mdb-icon> <span> Account Type </span>
                  </div>
  
                  <div class="col-md-7 profile-text">
                      <span> Service Provider </span>
                  </div>
                </div>

                <div class="row div-content">
                    <div class="col-md-5 inst-text">
                      <mdb-icon fas icon="tasks"></mdb-icon> <span> Service Category</span>
                    </div>
    
                    <div class="col-md-7 profile-text">
                        {{serviceProvider.service_category}} <br>
                        <div class="service-task" >
                            <div class="row container-fluid pd-top-min">
                                <div class="col-md-8">
                                    <b> Task Name </b>
                                </div>
                                <div class="col-md-4">
                                    <b> Fee </b>
                                </div>
                            </div>
                            <div class="row container-fluid" style="padding-top:8px;" *ngFor="let task of serviceProvider.tasks">
                                <div class="col-md-8">
                                    <mdb-icon fas icon="build"></mdb-icon> {{task.task}}
                                </div>
                                <div class="col-md-4">
                                    Rs. {{task.rate}}
                                </div>
                            </div>
                            
                        </div>
                    </div>
                  </div>
                  <hr>
                  
                  <!--row 4-->
                  <div class="row div-content">
                    <div class="col-md-5 inst-text">
                      <mdb-icon fas icon="key"></mdb-icon> <span> Password </span>
                    </div>
  
                    <div class="col-md-7 profile-text">
                        <span> ******* </span>
                    </div>
                  </div>

                  <div class="row div-content">
                      <div class="col-md-5"></div>
                      <div class="col-md-7">
                        <a type="button" mdbBtn color="green"
                        class="waves-light btn btn-md" mdbWavesEffect outline="yes" style="margin:0 auto; border-radius: 30px;"
                        (click)="changePasswordModal.show()">
                          Change Password
                    </a>
                      </div> 
                  </div>
                  <hr>
                    <!--row 3-->
                 <div class="row div-content">
                  <div class="col-md-5 inst-text">
                    <mdb-icon fas icon="calendar-check"></mdb-icon> <span> Registered Date </span>
                  </div>
  
                  <div class="col-md-7 profile-text">
                      <span> {{serviceProvider ? serviceProvider.reg_date.slice(0,10) : 'Loading...'}}</span>
                  </div>
                </div>
                </div>
                  <hr>
          </div>
       </div>
   </section>
  </div>
  
  
  <!--edit profile-->
  <div class="container-fluid" *ngIf="editmode && serviceProvider">
  
    <form class="service-form pd-top-min" #editProfile="ngForm" (submit)= "editUser(editProfile)">
  
    <section class="px-md-5 mx-md-5 dark-grey-text">
        <!--edit content-->
        <div class="pd-top-min text-center">

          <div class="row">
  
            <div class="col-md-3 inst-text" >
              <mdb-icon fas icon="award"></mdb-icon> <span> Profile Picture </span>
            </div>
  
            <div class="col-md-3 text-center">
              <a role="button" mdbWavesEffect (click)="img.click()">
                <img [src]="image ? imageUrl : serviceProvider.profile_pic"
                alt="Profile Picture" class="img-thumbnail logo-img-edit">
              </a>
              <input type="file" hidden="true" id="img" #img
              ngmodel name="image" accept="image/*" (change) = "onImageUploaded($event)">
              <p><b> Upload from your Device </b></p>
            </div>
  
          </div>
  
  
          <div class="row page-content">
            <div class="col-md-3 inst-text">
              <mdb-icon fas icon="file-signature"></mdb-icon> <span> Name </span>
            </div>
  
          <div class="col-md-7 text-center">
            <div class="row">
              <div class="col-md-6">
                <mat-form-field class="service-full-width">
                  <mat-label>First Name </mat-label>
                  <input matInput [ngModel]="serviceProvider.first_name" required
                  name="first_name" #firstName="ngModel">
                  <mat-error *ngIf="firstName.invalid">Please enter name</mat-error>
                </mat-form-field>
              </div>
              <div class="col-md-6">
                <mat-form-field class="service-full-width">
                  <mat-label>Last Name </mat-label>
                  <input matInput   [ngModel]="serviceProvider.last_name" required
                  #lastName="ngModel" name="last_name">
                  <mat-error *ngIf="lastName.invalid">Please enter name</mat-error>
                </mat-form-field>
              </div>
            </div>
           </div>
         </div>
  
  
  
            <!--row 2-->
            <div class="row page-content">
  
              <div class="col-md-3 inst-text">
                <mdb-icon fas icon="user"></mdb-icon> <span> Your NIC No.</span>
              </div>
  
              <div class="col-md-7 text-center">
                <mat-form-field class="service-full-width">
                  <mat-label>NIC Here </mat-label>
                  <input matInput [ngModel]="serviceProvider.nic" required
                  #nic="ngModel" name="nic" pattern="^([0-9]{9}[x|X|v|V]|[0-9]{12})$">
                  <mat-error *ngIf="nic.invalid">Please enter a valid NIC</mat-error>
                </mat-form-field>
              </div>
             </div>
  
           <!--row 2-->
           <div class="row page-content">
  
            <div class="col-md-3 inst-text">
              <mdb-icon fas icon="envelope"></mdb-icon> <span> Email Address</span>
                  </div>
  
            <div class="col-md-7 text-center">
              <mat-form-field class="service-full-width">
                <mat-label>Email Address here </mat-label>
                <input matInput [ngModel]="serviceProvider.email" required type="email"
                #email="ngModel" name="email" ngModel >
                <mat-error *ngIf="email.invalid">Please enter a valid email address</mat-error>
              </mat-form-field>
            </div>
           </div>
  
              <!--row 2-->
              <div class="row page-content">
  
                <div class="col-md-3 inst-text">
                  <mdb-icon fas icon="phone"></mdb-icon> <span> Contact No</span>
                </div>
  
                <div class="col-md-7 text-center">
                  <mat-form-field class="service-full-width">
                    <mat-label> Contact No here </mat-label>
                    <input matInput [ngModel]="serviceProvider.contact_no" required
                    #contactNo="ngModel" minlength="10" maxlength="10" name="contact_no">
                    <mat-error *ngIf="contactNo.invalid">Contact No should contain 10 digits</mat-error>
                  </mat-form-field>
                </div>
               </div>
  
  
               <!--row 3-->
               <div class="row  page-content">
  
                <div class="col-md-3 inst-text">
                  <mdb-icon fas icon="mercury"></mdb-icon> <span> Gender</span>
                </div>
  
                <div class="col-md-7 text-center">
                  <mat-form-field class="service-full-width">
                    <mat-label>Select Gender</mat-label>
                    <mat-select [ngModel]="serviceProvider.gender" required
                       ngModel name="gender">
                      <mat-option value="male">Male</mat-option>
                      <mat-option value="female">Female</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
               </div>
  
                <!--row 4-->
           <div class="row page-content">
  
            <div class="col-md-3 inst-text">
              <mdb-icon fas icon="birthday-cake"></mdb-icon> <span> Date of Birth:</span>
            </div>
  
            <div class="col-md-7 text-center">
              <mat-form-field class="service-full-width">
                <mat-label> Your Birthday </mat-label>
                <input matInput [matDatepicker]="picker" required
                name="date_of_birth" [ngModel]="serviceProvider.date_of_birth" #birthday="ngModel" />
                <mat-datepicker-toggle
                  matSuffix
                  [for]="picker"
                ></mat-datepicker-toggle>
                <mat-datepicker #picker [startAt]="serviceProvider.date_of_birth"></mat-datepicker>
                <mat-error *ngIf="birthday.invalid">Please select your Birthday</mat-error>
              </mat-form-field>
            </div>
           </div>
  
                 <!--row 6-->
              <div class="row  page-content">
  
                <div class="col-md-3 inst-text">
                  <mdb-icon fas icon="home"></mdb-icon> <span> Your Address</span>
                </div>
  
                <div class="col-md-7 text-center">
                  <mat-form-field class="service-full-width">
                    <mat-label>Address Line 1 </mat-label>
                    <input matInput [ngModel]="serviceProvider.address_line1" required
                    name="address_line1" #addressLine1="ngModel" ngModel>
                    <mat-error *ngIf="addressLine1.invalid">Address must be provided</mat-error>
                  </mat-form-field>
                  <mat-form-field class="service-full-width">
                    <mat-label>Address Line 2 </mat-label>
                    <input matInput [ngModel]="serviceProvider.address_line2" name="address_line2" ngModel>
                  </mat-form-field >
                  <mat-form-field class="service-full-width">
                    <mat-label> *District </mat-label>
                    <mat-select [ngModel]="serviceProvider.district" required
                    name="district"  ngModel>
                        <mat-option *ngFor="let district of districts" [value] ="district"> {{district}} </mat-option>
                    </mat-select>         
                  </mat-form-field>
                  <div class ="loc-btn pd-top-min">
                      <buttin class="btn btn-md" mdbBtn color="green" outline="yes" style="border-radius:30px;">
                        Set Permenant Location
                    </buttin>
                  </div>
                </div>
               </div>
             <hr>
             <div class="row  page-content">
             <div class="col-md-3 inst-text">
                <mdb-icon fas icon="tasks"></mdb-icon> <span> Service Category </span>
              </div>

              <div class="col-md-7 text-center">
                <mat-form-field class="service-full-width">
                    <mat-label>Service Category </mat-label>
                    <mat-select [ngModel]="serviceProvider.service_category" disabled
                    name="service_category"  ngModel (click) = "setCategory()">
                        <mat-option *ngFor="let cat of serviceCategories" [value] ="cat.id"> {{cat.category}} </mat-option>
                    </mat-select>         
                  </mat-form-field>
                  </div>
                </div>

                <div class="row  page-content">
                    <div class="col-md-3 inst-text">
                       <mdb-icon fas icon="tasks"></mdb-icon> <span> Add Service Tasks</span>
                     </div>
       
                     <div class="col-md-7 text-center" *ngIf="categoryMode">
                         <div class="sel-task">
                             <div class="row">
                                 <div class="col-md-5">
                                 

                                      <mat-form-field class="service-full-width">
                                        <mat-label>Task Name</mat-label>
                                        <mat-select ngModel 
                                            name="task_name"  [(ngModel)] = "tempTask.task">
                                                <mat-option *ngFor="let task of settedCategory.tasks" [value]="task.id"> {{task.task}} </mat-option>
                                            </mat-select>  
                                      </mat-form-field>
                                 </div>
                                 <div class="col-md-3">
                                    <mat-form-field class="service-full-width">
                                        <mat-label>Fee Type </mat-label>
                                        <mat-select ngModel 
                                            name="task_rate_type"  [(ngModel)] = "tempTask.rate_type">
                                                <mat-option *ngFor="let rate of rateTypes" [value]="rate"> {{rate}} </mat-option>
                                            </mat-select>  
                                      </mat-form-field>
                                 </div>
                                 <div class="col-md-3">
                                    <mat-form-field class="service-full-width">
                                        <mat-label>Fee (Rs.) </mat-label>
                                        <input matInput ngModel  type="number"
                                        name="task_rate" [(ngModel)] = "tempTask.rate">
                                    
                                      </mat-form-field>
                                 </div>
                                 <div class="col-md-1">
                                  <div class="col-md-1">
                                    <a class="btn btn-md" color="green" mdbBtn style="border-radius:50%;" (click) ="addNewTask()" [disabled] ="0 >= tempTask.rate"
                                     >
                                   +</a>
                                </div>
                                 </div>
                             </div>
                         </div>
                         <hr>
                         <h5> <b> Added tasks: </b> </h5>
                         <div class="row container-fluid" style="padding-top:8px;" *ngFor="let task of serviceProvider.tasks">
                          <div class="col-md-8">
                              <mdb-icon fas icon="build"></mdb-icon> {{task.task}}
                          </div>
                          <div class="col-md-4">
                              Rs. {{task.rate}}
                          </div>
                      </div>

                         <!-- new task adding
                         <div class="sel-task" *ngFor="let task of newTasks" >
                          <div class="row">
                              <div class="col-md-5">
                                 <mat-form-field class="service-full-width">
                                     <mat-label>Task Name </mat-label>
                                     <input matInput [ngModel]="task.task" required 
                                     name="task_name" #taskName="ngModel" ngModel>
                                     <mat-error *ngIf="taskName.invalid">Enter Value</mat-error>
                                   </mat-form-field>
                              </div>
                              <div class="col-md-3">
                                 <mat-form-field class="service-full-width">
                                     <mat-label>Fee Type </mat-label>
                                     <mat-select [ngModel]="task.rate_type" required
                                         name="task_rate_type"  ngModel>
                                             <option *ngFor="let rate of rateTypes"> {{rate}} </option>
                                         </mat-select>  
                                   </mat-form-field>
                              </div>
                              <div class="col-md-3">
                                 <mat-form-field class="service-full-width">
                                     <mat-label>Fee (Rs.) </mat-label>
                                     <input matInput [ngModel]="task.rate" required type="number"
                                     name="task_rate" #taskRate="ngModel" ngModel>
                                     <mat-error *ngIf="taskRate.invalid">Enter Value</mat-error>
                                   </mat-form-field>
                              </div>
                             
                          </div>
                      </div> -->
                      
                         </div>
                       </div>
             <hr>
  
      </div>
    </section>
  
    <!--save buttons-->
    <div class="text-center" style="padding-bottom:30px;">
      <button type="button" mdbBtn color="green"
      class="waves-light btn btn-md  cust-btn btn-tab" mdbWavesEffect style="border-radius:30px;"
      type="submit">Save Changes</button>
      <button type="button" mdbBtn color="green"
      class="waves-light btn btn-md  cust-btn btn-tab" mdbWavesEffect outline="yes"  style="border-radius:30px;"
      (click)="editmode = !editmode" (click) ="editProfile.resetForm()">Discard</button>
      </div>
  </form>
  </div>
  
  
  
  
  <!--change password Modal-->
  <div
    mdbModal
    #changePasswordModal="mdbModal"
    class="modal fade"
    tabindex="-1"
    role="dialog"
    aria-labelledby="myBasicModalLabel"
    [config]="{ backdrop: false, ignoreBackdropClick: true }"
    aria-hidden="true"
  >
  <form #pwordForm="ngForm" (submit)="changePassword(pwordForm)">
  
    <div
      class="modal-dialog modal-dialog-centered"
      role="document"
      style="overflow-y: initial !important"
    >
      <div class="modal-content">
        <div class="modal-header">
          <button
            type="button"
            class="close pull-right"
            aria-label="Close"
            (click)="changePasswordModal.hide()"
          >
            <span aria-hidden="true">×</span>
          </button>
          <h4 class="modal-title w-100" id="myModalLabel" >
            Change You Password
          </h4>
        </div>
        <div class="modal-body text-center" style="height: 320px; overflow-y: auto;" >
  
           <!--row 2-->
           <div class="row page-content">
  
            <div class="col-md-5 inst-text">
               <span> Current Password </span>
            </div>
  
            <div class="col-md-7 text-center">
              <mat-form-field class="service-full-width">
                <mat-label> Your current password </mat-label>
                <input type="password" matInput required
                name="current_password" #currentPword= "ngModel" ngModel>
                <mat-error *ngIf="currentPword.invalid">Current Password is required</mat-error>
              </mat-form-field>
            </div>
           </div>
           <hr>
  
           <!--row 2-->
           <div class="row page-content">
  
            <div class="col-md-5 inst-text">
              <span> New Password </span>
            </div>
  
            <div class="col-md-7 text-center">
              <mat-form-field class="service-full-width">
                <mat-label> Your new password </mat-label>
                <input type="password" matInput required
                name="new_password1"  #newPassword1="ngModel" ngModel>
                <mat-error *ngIf="newPassword1.invalid">New Password cannot be empty</mat-error>
              </mat-form-field>
            </div>
           </div>
  
           <!--row 2-->
           <div class="row">
  
            <div class="col-md-5 inst-text">
              <span> Retype Password </span>
            </div>
  
            <div class="col-md-7 text-center">
              <mat-form-field class="service-full-width">
                <mat-label>Retypeyour password </mat-label>
                <input type="password" matInput required
                name="new_password2" #newPassword2="ngModel" ngModel
                >
                <mat-error *ngIf="newPassword2.invalid">Plase re-type the password</mat-error>
              </mat-form-field>
            </div>
           </div>
  
        </div>
  
        <div class="modal-footer">
          <button
            mdbBtn class="btn btn-md"
            color="green"
            type="submit"
            mdbWavesEffect
            style="border-radius:30px;"
          >
            Change Password
          </button>
          <button
            mdbBtn class="btn btn-md"
            color="green"
            outline="yes"
            (click)="changePasswordModal.hide()"
            mdbWavesEffect
            style="border-radius:30px;"
          >
            Close
          </button>
        </div>
      </div>
    </div>
  </form>
  </div>
  
  